-- =============================================
-- ç´§å‡‘å‹å…¬å‘Šç¡®è®¤ç³»ç»Ÿ
-- ä½œè€…: AIåŠ©æ‰‹
-- ç‰ˆæœ¬: v1.0
-- =============================================

local CompactAnnouncement = {}
CompactAnnouncement.__index = CompactAnnouncement

function CompactAnnouncement:new()
    local system = setmetatable({}, CompactAnnouncement)
    system:initialize()
    return system
end

function CompactAnnouncement:initialize()
    self.isConfirmed = false
    self.announcementData = {
        title = "å…¬å‘Š",
        content = [[
æœ¬æ¬¡æ›´æ–°:

â€¢ æ›´æ–°äº†å…¬å‘Š
â€¢ å¡«åŠ å¡å¯†ç³»ç»Ÿ
â€¢ ä¼˜åŒ–äº†æµç•…åº¦
â€¢ æ–°å¢äº†è„šæœ¬

ç‚¹å‡»"åŒæ„"è¡¨ç¤ºæ‚¨å·²é˜…ä»¥ä¸Šå†…å®¹ã€‚
        ]],
        version = "v2.0.1"
    }
end

-- åˆ›å»ºç´§å‡‘å…¬å‘Šç•Œé¢
function CompactAnnouncement:createCompactUI()
    -- ä¸»GUI
    self.screenGui = Instance.new("ScreenGui")
    self.screenGui.Name = "CompactAnnouncement"
    self.screenGui.Parent = game:GetService("CoreGui")
    
    -- èƒŒæ™¯é®ç½©
    self.background = Instance.new("Frame")
    self.background.Size = UDim2.new(1, 0, 1, 0)
    self.background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    self.background.BackgroundTransparency = 0.4
    self.background.BorderSizePixel = 0
    self.background.Parent = self.screenGui
    
    -- ä¸»å…¬å‘Šæ¡† - æ›´å°å°ºå¯¸
    self.mainFrame = Instance.new("Frame")
    self.mainFrame.Size = UDim2.new(0, 400, 0, 300)  -- æ›´å°çš„å°ºå¯¸
    self.mainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
    self.mainFrame.BackgroundColor3 = Color3.fromRGB(25, 30, 45)
    self.mainFrame.BorderSizePixel = 0
    self.mainFrame.Parent = self.screenGui
    
    -- åœ†è§’
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = self.mainFrame
    
    -- è¾¹æ¡†
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(0, 120, 255)
    stroke.Thickness = 2
    stroke.Parent = self.mainFrame
    
    -- æ ‡é¢˜æ 
    self.titleBar = Instance.new("Frame")
    self.titleBar.Size = UDim2.new(1, 0, 0, 50)  -- æ›´çŸ®çš„æ ‡é¢˜æ 
    self.titleBar.BackgroundColor3 = Color3.fromRGB(35, 40, 60)
    self.titleBar.BorderSizePixel = 0
    self.titleBar.Parent = self.mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 12)
    titleCorner.Parent = self.titleBar
    
    -- æ ‡é¢˜æ–‡å­—
    self.titleLabel = Instance.new("TextLabel")
    self.titleLabel.Size = UDim2.new(1, -20, 1, 0)
    self.titleLabel.Position = UDim2.new(0, 10, 0, 0)
    self.titleLabel.BackgroundTransparency = 1
    self.titleLabel.Text = self.announcementData.title
    self.titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.titleLabel.TextSize = 20  -- æ›´å°çš„å­—ä½“
    self.titleLabel.Font = Enum.Font.GothamBold
    self.titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    self.titleLabel.Parent = self.titleBar
    
    -- å…³é—­å›¾æ ‡
    self.closeButton = Instance.new("TextButton")
    self.closeButton.Size = UDim2.new(0, 30, 0, 30)
    self.closeButton.Position = UDim2.new(1, -35, 0.5, -15)
    self.closeButton.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
    self.closeButton.Text = "Ã—"
    self.closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.closeButton.TextSize = 18
    self.closeButton.Font = Enum.Font.GothamBold
    self.closeButton.Parent = self.titleBar
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(1, 0)
    closeCorner.Parent = self.closeButton
    
    -- å†…å®¹åŒºåŸŸ
    self.contentFrame = Instance.new("Frame")
    self.contentFrame.Size = UDim2.new(1, -20, 0, 160)  -- æ›´å°çš„å†…å®¹åŒºåŸŸ
    self.contentFrame.Position = UDim2.new(0, 10, 0, 60)
    self.contentFrame.BackgroundColor3 = Color3.fromRGB(30, 35, 50)
    self.contentFrame.BorderSizePixel = 0
    self.contentFrame.Parent = self.mainFrame
    
    local contentCorner = Instance.new("UICorner")
    contentCorner.CornerRadius = UDim.new(0, 8)
    contentCorner.Parent = self.contentFrame
    
    -- å†…å®¹æ–‡å­—
    self.contentLabel = Instance.new("TextLabel")
    self.contentLabel.Size = UDim2.new(1, -20, 1, -20)
    self.contentLabel.Position = UDim2.new(0, 10, 0, 10)
    self.contentLabel.BackgroundTransparency = 1
    self.contentLabel.Text = self.announcementData.content
    self.contentLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
    self.contentLabel.TextSize = 14  -- æ›´å°çš„å­—ä½“
    self.contentLabel.Font = Enum.Font.Gotham
    self.contentLabel.TextXAlignment = Enum.TextXAlignment.Left
    self.contentLabel.TextYAlignment = Enum.TextYAlignment.Top
    self.contentLabel.TextWrapped = true
    self.contentLabel.Parent = self.contentFrame
    
    -- ç‰ˆæœ¬ä¿¡æ¯
    self.versionLabel = Instance.new("TextLabel")
    self.versionLabel.Size = UDim2.new(1, -20, 0, 20)
    self.versionLabel.Position = UDim2.new(0, 10, 0, 230)
    self.versionLabel.BackgroundTransparency = 1
    self.versionLabel.Text = self.announcementData.version
    self.versionLabel.TextColor3 = Color3.fromRGB(150, 150, 200)
    self.versionLabel.TextSize = 12
    self.versionLabel.Font = Enum.Font.Gotham
    self.versionLabel.TextXAlignment = Enum.TextXAlignment.Left
    self.versionLabel.Parent = self.mainFrame
    
    -- æŒ‰é’®å®¹å™¨
    self.buttonContainer = Instance.new("Frame")
    self.buttonContainer.Size = UDim2.new(1, -20, 0, 40)
    self.buttonContainer.Position = UDim2.new(0, 10, 1, -50)
    self.buttonContainer.BackgroundTransparency = 1
    self.buttonContainer.Parent = self.mainFrame
    
    -- æ‹’ç»æŒ‰é’®
    self.declineButton = Instance.new("TextButton")
    self.declineButton.Size = UDim2.new(0, 100, 0, 40)
    self.declineButton.Position = UDim2.new(0, 0, 0, 0)
    self.declineButton.Text = "æˆ‘æ˜¯ä¹å­æˆ‘ä¸ä¸çŸ¥é“ğŸ¤“"
    self.declineButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.declineButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    self.declineButton.TextSize = 14
    self.declineButton.Font = Enum.Font.GothamBold
    self.declineButton.Parent = self.buttonContainer
    
    local declineCorner = Instance.new("UICorner")
    declineCorner.CornerRadius = UDim.new(0, 8)
    declineCorner.Parent = self.declineButton
    
    -- åŒæ„æŒ‰é’®
    self.agreeButton = Instance.new("TextButton")
    self.agreeButton.Size = UDim2.new(0, 100, 0, 40)
    self.agreeButton.Position = UDim2.new(1, -100, 0, 0)
    self.agreeButton.Text = "æˆ‘æ˜¯èªæ˜å…¥æˆ‘å·²é˜…"
    self.agreeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.agreeButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    self.agreeButton.TextSize = 14
    self.agreeButton.Font = Enum.Font.GothamBold
    self.agreeButton.Parent = self.buttonContainer
    
    local agreeCorner = Instance.new("UICorner")
    agreeCorner.CornerRadius = UDim.new(0, 8)
    agreeCorner.Parent = self.agreeButton
    
    -- è®¾ç½®æŒ‰é’®æ•ˆæœ
    self:setupButtonEffects()
    
    -- ç»‘å®šäº‹ä»¶
    self:setupEvents()
end

-- è®¾ç½®æŒ‰é’®æ‚¬åœæ•ˆæœ
function CompactAnnouncement:setupButtonEffects()
    -- å…³é—­æŒ‰é’®æ•ˆæœ
    self.closeButton.MouseEnter:Connect(function()
        self.closeButton.BackgroundColor3 = Color3.fromRGB(120, 80, 80)
    end)
    
    self.closeButton.MouseLeave:Connect(function()
        self.closeButton.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
    end)
    
    -- æ‹’ç»æŒ‰é’®æ•ˆæœ
    self.declineButton.MouseEnter:Connect(function()
        self.declineButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
    end)
    
    self.declineButton.MouseLeave:Connect(function()
        self.declineButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    end)
    
    -- åŒæ„æŒ‰é’®æ•ˆæœ
    self.agreeButton.MouseEnter:Connect(function()
        self.agreeButton.BackgroundColor3 = Color3.fromRGB(60, 180, 60)
    end)
    
    self.agreeButton.MouseLeave:Connect(function()
        self.agreeButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    end)
end

-- è®¾ç½®äº‹ä»¶ç»‘å®š
function CompactAnnouncement:setupEvents()
    -- å…³é—­æŒ‰é’®
    self.closeButton.MouseButton1Click:Connect(function()
        self:onDecline()
    end)
    
    -- æ‹’ç»æŒ‰é’®
    self.declineButton.MouseButton1Click:Connect(function()
        self:onDecline()
    end)
    
    -- åŒæ„æŒ‰é’®
    self.agreeButton.MouseButton1Click:Connect(function()
        self:onAgree()
    end)
end

-- æ‹’ç»æ“ä½œ
function CompactAnnouncement:onDecline()
    -- æ˜¾ç¤ºç®€çŸ­æç¤º
    self.titleLabel.Text = "âŒ å·²å–æ¶ˆ"
    self.contentLabel.Text = "æ‚¨éœ€è¦åŒæ„ä½¿ç”¨æ¡æ¬¾æ‰èƒ½ç»§ç»­ä½¿ç”¨æœ¬å·¥å…·ã€‚"
    self.agreeButton.Visible = false
    self.declineButton.Visible = false
    self.closeButton.Visible = false
    
    -- 2ç§’åå…³é—­
    wait(2)
    self:destroy()
end

-- åŒæ„æ“ä½œ
function CompactAnnouncement:onAgree()
    self.isConfirmed = true
    
    -- æ›´æ–°ç•Œé¢çŠ¶æ€
    self.titleLabel.Text = "âœ… å·²åŒæ„"
    self.agreeButton.Text = "åŠ è½½ä¸­..."
    self.agreeButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
    self.agreeButton.Active = false
    self.declineButton.Active = false
    self.closeButton.Active = false
    
    -- æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    self.contentLabel.Text = "æ­£åœ¨åˆå§‹åŒ–ç³»ç»Ÿ..."
    
    -- 1ç§’åæ‰§è¡Œå›è°ƒ
    wait(1)
    
    if self.confirmCallback then
        self.confirmCallback()
    end
    
    self:destroy()
end

-- æ˜¾ç¤ºå…¬å‘Š
function CompactAnnouncement:show(callback)
    self.confirmCallback = callback
    self:createCompactUI()
    
    -- è¿”å›ä¸€ä¸ªPromiseé£æ ¼çš„æ¥å£
    return {
        waitForConfirm = function()
            while not self.isConfirmed do
                wait(0.1)
            end
            return true
        end
    }
end

-- å¿«é€Ÿæ˜¾ç¤ºæ–¹æ³•
function CompactAnnouncement:quickShow(callback)
    self.confirmCallback = callback
    self:createCompactUI()
end

-- é”€æ¯ç•Œé¢
function CompactAnnouncement:destroy()
    if self.screenGui then
        self.screenGui:Destroy()
        self.screenGui = nil
    end
end

-- =============================================
-- è¶…è¿·ä½ ç‰ˆæœ¬ï¼ˆæœ€å°å°ºå¯¸ï¼‰
-- =============================================

local MiniAnnouncement = {}
MiniAnnouncement.__index = MiniAnnouncement

function MiniAnnouncement:new()
    local system = setmetatable({}, MiniAnnouncement)
    return system
end

function MiniAnnouncement:show(callback)
    -- åˆ›å»ºæœ€å°åŒ–UI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = game:GetService("CoreGui")
    
    -- ä¸»æ¡†æ¶
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 300, 0, 200)  -- æœ€å°å°ºå¯¸
    mainFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 35, 50)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mainFrame
    
    -- æ ‡é¢˜
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 40)
    title.BackgroundColor3 = Color3.fromRGB(40, 45, 65)
    title.Text = "å…¬å‘Š"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 16
    title.Font = Enum.Font.GothamBold
    title.Parent = mainFrame
    
    -- å†…å®¹
    local content = Instance.new("TextLabel")
    content.Size = UDim2.new(1, -20, 0, 100)
    content.Position = UDim2.new(0, 10, 0, 50)
    content.BackgroundTransparency = 1
    content.Text = "ä½¿ç”¨æ­¤è„šæœ¬å³è¡¨ç¤ºæ‚¨å·²é˜…è¯»å…¬å‘Šã€‚\n\nè¯·ç‚¹å‡»'åŒæ„'ç»§ç»­ã€‚"
    content.TextColor3 = Color3.fromRGB(220, 220, 255)
    content.TextSize = 12
    content.TextWrapped = true
    content.Parent = mainFrame
    
    -- æŒ‰é’®å®¹å™¨
    local buttonContainer = Instance.new("Frame")
    buttonContainer.Size = UDim2.new(1, -20, 0, 35)
    buttonContainer.Position = UDim2.new(0, 10, 1, -45)
    buttonContainer.BackgroundTransparency = 1
    buttonContainer.Parent = mainFrame
    
    -- æ‹’ç»æŒ‰é’®
    local declineBtn = Instance.new("TextButton")
    declineBtn.Size = UDim2.new(0, 80, 0, 35)
    declineBtn.Text = "æˆ‘æ˜¯ä¹å­æˆ‘çœ‹ä¸æ‡‚å…¬å‘Š"
    declineBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    declineBtn.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    declineBtn.TextSize = 12
    declineBtn.Font = Enum.Font.GothamBold
    declineBtn.Parent = buttonContainer
    
    local declineCorner = Instance.new("UICorner")
    declineCorner.CornerRadius = UDim.new(0, 6)
    declineCorner.Parent = declineBtn
    
    -- åŒæ„æŒ‰é’®
    local agreeBtn = Instance.new("TextButton")
    agreeBtn.Size = UDim2.new(0, 80, 0, 35)
    agreeBtn.Position = UDim2.new(1, -80, 0, 0)
    agreeBtn.Text = "æˆ‘æ˜¯èªæ˜å…¥æˆ‘å·²é˜…è¯»"
    agreeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    agreeBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    agreeBtn.TextSize = 12
    agreeBtn.Font = Enum.Font.GothamBold
    agreeBtn.Parent = buttonContainer
    
    local agreeCorner = Instance.new("UICorner")
    agreeCorner.CornerRadius = UDim.new(0, 6)
    agreeCorner.Parent = agreeBtn
    
    -- æŒ‰é’®äº‹ä»¶
    declineBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)
    
    agreeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
        if callback then
            callback()
        end
    end)
end

-- =============================================
-- ä½¿ç”¨ç¤ºä¾‹
-- =============================================

-- æ–¹æ³•1ï¼šä½¿ç”¨ç´§å‡‘ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
local announcement = CompactAnnouncement:new()
announcement:quickShow(function()
    print("ç”¨æˆ·å·²åŒæ„ï¼Œæ‰§è¡Œä¸»è„šæœ¬...")
    loadstring(game:HttpGet("https://raw.githubusercontent.com/liuliuqiang404-code/-/refs/heads/main/åˆ˜æŸåŠ¨ç”»ç‰ˆ"))()
end)

-- æ–¹æ³•2ï¼šä½¿ç”¨è¶…è¿·ä½ ç‰ˆæœ¬
-- local mini = MiniAnnouncement:new()
-- mini:show(function()
--     print("ç”¨æˆ·å·²åŒæ„ï¼Œæ‰§è¡Œä¸»è„šæœ¬...")
--     -- åœ¨è¿™é‡Œæ‰§è¡Œæ‚¨çš„ä¸»è„šæœ¬
-- end)

return {
    Compact = CompactAnnouncement,
    Mini = MiniAnnouncement
}